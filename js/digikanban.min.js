window.digikanban||(window.digikanban={},window.digikanban.scriptsLoaded=!1),window.digikanban.scriptsLoaded||(window.digikanban.init=function(){window.digikanban.load_list_script()},window.digikanban.load_list_script=function(){if(!window.digikanban.scriptsLoaded){var n=void 0,i=void 0;for(n in window.digikanban)for(i in window.digikanban[n].init&&window.digikanban[n].init(),window.digikanban[n])window.digikanban[n]&&window.digikanban[n][i]&&window.digikanban[n][i].init&&window.digikanban[n][i].init();window.digikanban.scriptsLoaded=!0}},window.digikanban.refresh=function(){var n=void 0,i=void 0;for(n in window.digikanban)for(i in window.digikanban[n].refresh&&window.digikanban[n].refresh(),window.digikanban[n])window.digikanban[n]&&window.digikanban[n][i]&&window.digikanban[n][i].refresh&&window.digikanban[n][i].refresh()},$(document).ready(window.digikanban.init)),window.digikanban.kanban={},window.digikanban.kanban.init=function(){window.digikanban.kanban.event()},window.digikanban.kanban.event=function(){$(document).on("change",".kanban-select-option",window.digikanban.kanban.selectOption),$(document).on("click",".validate-button:not(.butActionRefused)",window.digikanban.kanban.addObjectToColumn),$(".info-box").attr("draggable","true"),$(".kanban-column-body").sortable({connectWith:".kanban-column-body",placeholder:"kanban-placeholder",handle:".info-box",tolerance:"pointer",over:function(){$(this).css("cursor","grabbing")},stop:function(n,i){window.digikanban.kanban.saveCardOrder()}})},window.digikanban.kanban.saveCardOrder=function(){var n=$("#object_type").val();let a=[];$(".kanban-column").each(function(){var n=$(this).attr("category-id");let i=[];$(this).find(".info-box").each(function(){console.log($(this).find("checkbox")),i.push($(this).find(".checkforselect").attr("value"))}),a.push({columnId:n,cards:i})});var i=$("#ajax_actions_url").val(),o=window.saturne.toolbox.getToken();$.ajax({url:i+"?action=move_object&token="+o+"&object_type="+n,type:"POST",data:JSON.stringify({order:a}),contentType:"application/json",success:function(n){console.log("Card order saved successfully.")},error:function(){console.log("Error saving card order.")}})},window.digikanban.kanban.addColumn=function(){var n=document.getElementById("kanban-board"),i=document.createElement("div"),a=(i.classList.add("kanban-column"),i.innerHTML=`
        <div class="kanban-column-header">
            <span class="column-name" ondblclick="window.digikanban.kanban.editColumn(this)">Nouvelle colonne</span>
            <i class="fas fa-pencil-alt edit-icon" onclick="window.digikanban.kanban.editColumn(this.previousElementSibling)"></i>
        </div>
        <div class="kanban-column-body">
        </div>
        <div class="add-item">
            <button onclick="window.digikanban.kanban.showSelect(this)">+ Ajouter un objet</button>
        </div>
    `,document.querySelector(".kanban-add-column"));n.insertBefore(i,a)},window.digikanban.kanban.editColumn=function(i){var n=i.innerText;let a=document.createElement("input");a.type="text",a.value=n,a.classList.add("column-name-input"),a.addEventListener("keypress",function(n){"Enter"===n.key&&(i.innerText=a.value,i.style.display="inline",a.remove())}),i.style.display="none",i.parentNode.insertBefore(a,i),a.focus()},window.digikanban.kanban.selectOption=function(){var n=$(this).parent().find(".validate-button");n.removeClass("butActionRefused"),n.removeAttr("disabled")},window.digikanban.kanban.addObjectToColumn=function(){var n=$(this).parent().find(".kanban-select-option").val();let i=$(this).closest(".kanban-column").attr("category-id");var a=window.saturne.toolbox.getToken(),o=$("#object_type").val(),e=$("#ajax_actions_url").val();e+="?action=add_object_to_column&object_id="+n+"&category_id="+i+"&token="+a+"&object_type="+o,$.ajax({url:e,type:"POST",processData:!1,contentType:!1,success:function(n){$('.kanban-column[category-id="'+i+'"]').find(".kanban-column-body").append(n)},error:function(){console.log("Failed to add object to column.")}})};